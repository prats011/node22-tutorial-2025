<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <button id='send'>
        SEND
    </button>
    <button id="del">
        DELETE
    </button>
    <button id="pCreate">
        Put Create
    </button>
    <button id="pUpdate">
        Put Update
    </button>
    <div id="timeContainer">
        <p>Timestamps:</p>
        <ul id="timeStampList"></ul>

    </div>
</body>
<script>

    //Following fucntion sources from:https://stackoverflow.com/questions/23850115/trying-to-get-a-timestamp-inputed-upon-a-click-of-the-button
    // & https://www.w3schools.com/jsref/met_node_insertbefore.asp
    //getTimeStamp()
    //setTime()
    const btn = document.getElementById('send');
    async function sendMsg() {
        const res = await fetch('/api/info?id=8', {
            method: 'POST',
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ information: "This is from the web client" })
        });
        console.log("REQUEST SENT");
        setTime()
        
    }
    btn.addEventListener('click', sendMsg, setTime);

    const btnDel = document.getElementById('del');
    async function delMsg() {
        const res = await fetch('/delete?id=8', {
            method: 'DELETE'
        });
        console.log("DELETE SENT");
        setTime()
    }
    btnDel.addEventListener('click', delMsg, setTime);

    const btnpCreate = document.getElementById('pCreate');
    async function pCreate() {
        const res = await fetch('/api/create?id=8', {
            method: 'PUT',
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ information: "You were using this website" })
        });
        console.log("PUT CREATE SENT");
        setTime()
    }
    btnpCreate.addEventListener('click', pCreate, setTime);

    const btnpUpdate = document.getElementById('pUpdate');
    async function pUpdate() {
        const res = await fetch('/api/update?id=8', {
            method: 'PUT',
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                information: "This is from the web client",
                newInformation: "You are using the website"
            })
        });
        console.log("PUT UPDATE SENT");
        setTime()
    }
    btnpUpdate.addEventListener('click', pUpdate, setTime);

    function getTimeStamp() {
        var now = new Date();
        return ('<' + (now.getMonth() + 1) + '-' + (now.getDate()) + '-' + now.getFullYear() + ' ' + now.getHours() + ':'
            + ((now.getMinutes() < 10) ? ("0" + now.getMinutes()) : (now.getMinutes())) + ':' +
            ((now.getSeconds() < 10) ? ("0" + now.getSeconds()) : (now.getSeconds())) + '>');
    }
    function setTime() {
        const time = getTimeStamp()
        const newNode = document.createElement('li')
        const details = document.createTextNode(time)
        newNode.appendChild(details)
        const list = document.getElementById("timeStampList")
        list.insertBefore(newNode, list.children[0])

    }
</script>

</html>